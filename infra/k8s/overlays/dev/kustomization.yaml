apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: agrosolutions-dev
resources:
- namespace.yaml
- monitoring/servicemonitors.yaml
- ../../base/analise
- ../../base/ingestao
- ../../base/propriedades
- ../../base/usuarios
- ../../base/observability
- ../../base/sqlserver-deployment.yaml
- ../../base/db-init-job.yaml
- ../../rabbitmq

images:
- name: analise
  newName: ajmarzola/agrosolutions-analise
  newTag: dev
- name: ingestao
  newName: ajmarzola/agrosolutions-ingestao
  newTag: dev
- name: ingestao-simulador
  newName: ajmarzola/agrosolutions-ingestao-simulador
  newTag: dev
- name: propriedades
  newName: ajmarzola/agrosolutions-propriedades
  newTag: dev
- name: usuarios
  newName: ajmarzola/agrosolutions-usuarios
  newTag: dev

labels:
- pairs:
    app.kubernetes.io/part-of: agrosolutions-platform
    app.kubernetes.io/managed-by: kustomize
    env: dev

secretGenerator:
- name: sql-server-secret
  envs:
  - .env
- name: agrosolutions-auth-secrets
  envs:
  - .env
- name: rabbitmq-secret
  envs:
  - .env


patchesStrategicMerge:
- configmap-env-patch.yaml
- monitoring/service-labels.patch.yaml
- db-resources.patch.yaml
- rabbitmq-resources.patch.yaml
